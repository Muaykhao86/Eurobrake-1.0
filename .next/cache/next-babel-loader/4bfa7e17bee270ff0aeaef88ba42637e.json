{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/mnt/c/Users/D.Hardiman/desktop/eurobrake/pages/authorsAreaDash.js\";\nvar __jsx = React.createElement;\nimport React, { Component } from 'react';\nimport Router from 'next/router';\nimport fetch from 'isomorphic-unfetch';\nimport styled from 'styled-components';\nimport { withAuthSync, logout, login } from '../utils/auth';\nimport cookies from 'next-cookies';\nimport cookie from 'js-cookie';\nimport Login from '../components/login';\nvar StyledPage = styled.div.withConfig({\n  displayName: \"authorsAreaDash__StyledPage\",\n  componentId: \"sc-1jtqy5t-0\"\n})([\"display:flex;flex-direction:column;align-self:center;max-width:\", \";background-color:\", \";.authors{color:\", \";font-family:\", \";font-size:2rem;&-title{color:\", \";font-family:\", \";font-size:4.4rem;margin-top:3rem;margin-bottom:3rem;}&_sub-title{color:\", \";font-size:3.5rem;font-family:\", \";padding-bottom:.5rem;margin-bottom:3rem;}&-bold{font-family:\", \";}&-it{font-family:\", \";}}\"], function (props) {\n  return props.theme.maxWidth;\n}, function (props) {\n  return props.theme.white;\n}, function (props) {\n  return props.theme.primary;\n}, function (props) {\n  return props.theme.MPLight;\n}, function (props) {\n  return props.theme.primary;\n}, function (props) {\n  return props.theme.MPSemibold;\n}, function (props) {\n  return props.theme.primary;\n}, function (props) {\n  return props.theme.MPLightIt;\n}, function (props) {\n  return props.theme.MPBold;\n}, function (props) {\n  return props.theme.MPLightIt;\n});\n\nvar AuthorsAreaDash =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(AuthorsAreaDash, _Component);\n\n  function AuthorsAreaDash(props) {\n    var _this;\n\n    _classCallCheck(this, AuthorsAreaDash);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AuthorsAreaDash).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidMount\", function () {\n      var userLoggedIn = _this.state.userLoggedIn;\n\n      var _cookie$get = cookie.get(),\n          logintoken = _cookie$get.logintoken;\n\n      console.log('cdm', logintoken);\n      logintoken && !userLoggedIn ? _this.setState(function (prev) {\n        return {\n          userLoggedIn: !prev\n        };\n      }) : null;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getAbstractForm\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(e) {\n        var _cookie$get2, logintoken, apiUrl, response, data, error;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                e.preventDefault();\n                console.log('click');\n                _cookie$get2 = cookie.get(), logintoken = _cookie$get2.logintoken;\n                console.log(logintoken);\n                _context.prev = 4;\n                apiUrl = 'https://prelude.eurobrake.net/submit';\n                _context.next = 8;\n                return fetch(apiUrl, {\n                  credentials: 'include',\n                  headers: {\n                    Authorization: \"Bearer \".concat(logintoken)\n                  }\n                });\n\n              case 8:\n                response = _context.sent;\n                _context.next = 11;\n                return response.json();\n\n              case 11:\n                data = _context.sent;\n\n                if (!(data.status === 'success')) {\n                  _context.next = 17;\n                  break;\n                }\n\n                _this.setState(function (prev) {\n                  return {\n                    hasForm: !prev,\n                    formData: data.form\n                  };\n                }); // console.log(data.form);\n                // console.log('stringify',JSON.stringify(data.form));\n\n\n                console.log(data);\n                _context.next = 20;\n                break;\n\n              case 17:\n                error = new Error(data.error);\n                error.response = response;\n                throw error;\n\n              case 20:\n                _context.next = 26;\n                break;\n\n              case 22:\n                _context.prev = 22;\n                _context.t0 = _context[\"catch\"](4);\n                console.error('Failed to get form, please try again', _context.t0);\n\n                _this.setState({\n                  error: _context.t0.message\n                });\n\n              case 26:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[4, 22]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"handleInputChange\", function (event) {\n      var target = event.target;\n      var value = target.type === 'checkbox' ? target.checked : target.value;\n      var name = target.name;\n\n      _this.setState(_defineProperty({}, name, value));\n    });\n\n    _this.state = {\n      hasForm: false,\n      formData: undefined,\n      error: '',\n      userLoggedIn: false\n    };\n    return _this;\n  }\n\n  _createClass(AuthorsAreaDash, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          userLoggedIn = _this$state.userLoggedIn,\n          hasForm = _this$state.hasForm;\n      console.log({\n        userLoggedIn: userLoggedIn,\n        hasForm: hasForm\n      });\n      return __jsx(React.Fragment, null, __jsx(HeroSection, {\n        banner: FilledBanner,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, \"AuthorsArea\"), __jsx(StyledPage, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, __jsx(Typography, {\n        className: \"authors-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, \"Welcome to the Author's Area\"), __jsx(Typography, {\n        gutterBottom: true,\n        className: \"authors\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }, \"Presenting a paper at EuroBrake gives you the opportunity to share your latest technical ideas and achievements with influential specialists from around the world and to discuss your work with colleagues throughout the industrial and academic communities.\"), __jsx(Typography, {\n        gutterBottom: true,\n        className: \"authors\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, \"Once you have created your author account you can login at any time to amend your details and access important information. \"), __jsx(Typography, {\n        gutterBottom: true,\n        className: \"authors authors-it\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, \"Please note that all submitting authors will need to create a new author account for EuroBrake 2020 as account are not copied from year to year.\"), __jsx(Typography, {\n        className: \"authors_sub-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, \"Submit your review ready papers by 26 January 2020.\"), __jsx(\"button\", {\n        onClick: this.getAbstractForm,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, \"Submit a Abstract\"), __jsx(\"button\", {\n        onClick: logout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, \"logout\")));\n    }\n  }]);\n\n  return AuthorsAreaDash;\n}(Component);\n\nAuthorsAreaDash.getInitialProps =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(ctx) {\n    var _cookies, logintoken, apiUrl, redirectOnError, response, data;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            // We use `nextCookie` to get the cookie and pass the token to the frontend in the `props`.\n            _cookies = cookies(ctx), logintoken = _cookies.logintoken;\n            apiUrl = 'https://prelude.eurobrake.net/dashboard ';\n\n            redirectOnError = function redirectOnError() {\n              return process.browser ? Router.push('/authorsArea') : ctx.res.writeHead(301, {\n                Location: '/authorsArea'\n              });\n            };\n\n            if (!logintoken) {\n              _context2.next = 24;\n              break;\n            }\n\n            _context2.prev = 4;\n            _context2.next = 7;\n            return fetch(apiUrl, {\n              credentials: 'include',\n              cache: 'no-cache',\n              headers: {\n                Authorization: 'Bearer ' + logintoken\n              }\n            });\n\n          case 7:\n            response = _context2.sent;\n            _context2.next = 10;\n            return response.json();\n\n          case 10:\n            data = _context2.sent;\n\n            if (!(data.status === 'success')) {\n              _context2.next = 16;\n              break;\n            }\n\n            console.log('res.ok', data);\n            return _context2.abrupt(\"return\", {\n              authorData: data\n            });\n\n          case 16:\n            console.log('not reading success'); // https://github.com/developit/unfetch#caveats\n\n            return _context2.abrupt(\"return\", redirectOnError());\n\n          case 18:\n            _context2.next = 24;\n            break;\n\n          case 20:\n            _context2.prev = 20;\n            _context2.t0 = _context2[\"catch\"](4);\n            // Implementation or Network error\n            console.log(_context2.t0);\n            return _context2.abrupt(\"return\", redirectOnError());\n\n          case 24:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[4, 20]]);\n  }));\n\n  return function (_x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nexport default withAuthSync(AuthorsAreaDash); // export default AuthorsArea;\n// !\n// ?\n// *\n// todo\n\n{}\n/* <div className=\"form-container\">\n               <form>\n               {this.state.hasForm &&\n               \n              this.state.formdata.map(component => {\n                return(\n                       <div className=\"form-item\">\n                       {component.title ? <title>{component.title}</title> : null }\n                       {component.type ? \n                       <label>\n                       {component.options ? null : component.label}\n                       <input\n                       required={component.options ?  null : component.required ? component.required : null}\n                        name={component.name}\n                        type={component.type}\n                        value={this.state.name}\n                        onChange={this.handleInputChange}\n                       /> \n                       </label>\n                       : null\n                       }\n                       {component.options ? \n                       <label>\n                           {component.label}\n                       <select name={component.name} >\n                           {component.options.map( option => {\n                               return( \n                                       <option value={option.value}>{option.label}</option>\n                               )\n                           })}\n                       </select> \n                       </label>    \n                       : null}\n                       {component.default ? <default>{component.default}</default> : null}\n                        </div>\n                )\n                   }\n               )\n               }\n               </form>\n               </div> */\n// //","map":{"version":3,"sources":["/mnt/c/Users/D.Hardiman/desktop/eurobrake/pages/authorsAreaDash.js"],"names":["React","Component","Router","fetch","styled","withAuthSync","logout","login","cookies","cookie","Login","StyledPage","div","props","theme","maxWidth","white","primary","MPLight","MPSemibold","MPLightIt","MPBold","AuthorsAreaDash","userLoggedIn","state","get","logintoken","console","log","setState","prev","e","preventDefault","apiUrl","credentials","headers","Authorization","response","json","data","status","hasForm","formData","form","error","Error","message","event","target","value","type","checked","name","undefined","FilledBanner","getAbstractForm","getInitialProps","ctx","redirectOnError","process","browser","push","res","writeHead","Location","cache","authorData"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport Router from 'next/router';\nimport fetch from 'isomorphic-unfetch';\nimport styled from 'styled-components';\nimport { withAuthSync, logout, login } from '../utils/auth'\nimport cookies from 'next-cookies';\nimport cookie from 'js-cookie';\nimport Login from '../components/login';\n\nconst StyledPage = styled.div`\n    display: flex;\n    flex-direction: column;\n    align-self: center;\n    max-width: ${props => props.theme.maxWidth};\n    background-color: ${props => props.theme.white};\n\n    .authors{\n        color: ${props => props.theme.primary};\n        font-family: ${props => props.theme.MPLight};\n        font-size: 2rem;\n   \n    &-title{\n        color: ${props => props.theme.primary};\n        font-family: ${props => props.theme.MPSemibold};\n        font-size: 4.4rem;\n        margin-top: 3rem;\n        margin-bottom: 3rem;\n    }\n   \n    &_sub-title{\n        color: ${props => props.theme.primary};\n        font-size: 3.5rem;\n        font-family: ${props => props.theme.MPLightIt};\n        padding-bottom: .5rem;\n        margin-bottom: 3rem;\n    }\n    &-bold{\n        font-family: ${props => props.theme.MPBold};\n    }\n    &-it{\n        font-family: ${props => props.theme.MPLightIt};\n    }\n}\n`;\n\nclass AuthorsAreaDash extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            hasForm: false,\n            formData: undefined,\n            error: '',\n            userLoggedIn: false,\n        }\n\n\n    }\n\n\n    componentDidMount = () => {\n        const { userLoggedIn } = this.state;\n        const { logintoken } = cookie.get();\n        console.log('cdm', logintoken)\n        logintoken && !userLoggedIn ? this.setState(prev => ({\n            userLoggedIn: !prev\n        })) : null\n\n    }\n\n    getAbstractForm = async (e) => {\n        e.preventDefault()\n        console.log('click');\n        const { logintoken } = cookie.get();\n        console.log(logintoken)\n        try {\n            const apiUrl = 'https://prelude.eurobrake.net/submit';\n            const response = await fetch(apiUrl, {\n                credentials: 'include',\n                headers: {\n                    Authorization: `Bearer ${logintoken}`,\n                }\n            });\n            const data = await response.json();\n            if (data.status === 'success') {\n                this.setState(prev => (\n                    {\n                        hasForm: !prev,\n                        formData: data.form\n                    }));\n                // console.log(data.form);\n                // console.log('stringify',JSON.stringify(data.form));\n                console.log(data)\n\n\n            } else {\n                let error = new Error(data.error)\n                error.response = response\n                throw error\n            }\n        } catch (error) {\n            console.error(\n                'Failed to get form, please try again', error\n            )\n            this.setState({ error: error.message });\n        }\n    }\n\n\n    handleInputChange = (event) => {\n        const target = event.target;\n        const value = target.type === 'checkbox' ? target.checked : target.value;\n        const name = target.name;\n\n        this.setState({\n            [name]: value\n        });\n    }\n\n    render() {\n\n        const { userLoggedIn, hasForm } = this.state;\n        console.log({ userLoggedIn, hasForm });\n        return (\n            <>\n            <HeroSection banner={FilledBanner}>\n                    AuthorsArea\n            </HeroSection>\n                <StyledPage>\n                    {/* <PopupLogin/> */}\n                    <Typography className=\"authors-title\">Welcome to the Author's Area</Typography>\n                    <Typography gutterBottom className=\"authors\">Presenting a paper at EuroBrake gives you the opportunity to share your latest technical ideas and achievements with influential specialists from around the world and to discuss your work with colleagues throughout the industrial and academic communities.</Typography>\n                    <Typography gutterBottom className=\"authors\">Once you have created your author account you can login at any time to amend your details and access important information. </Typography>\n                    <Typography gutterBottom className=\"authors authors-it\">Please note that all submitting authors will need to create a new author account for EuroBrake 2020 as account are not copied from year to year.</Typography>\n                    <Typography className=\"authors_sub-title\">Submit your review ready papers by 26 January 2020.</Typography>\n            <button onClick={this.getAbstractForm}>Submit a Abstract</button>\n            <button onClick={logout}>logout</button>\n            </StyledPage>\n            </>\n\n           )\n\n    }\n}\n\nAuthorsAreaDash.getInitialProps = async ctx => {\n    // We use `nextCookie` to get the cookie and pass the token to the frontend in the `props`.\n    const { logintoken } = cookies(ctx);\n    const apiUrl = 'https://prelude.eurobrake.net/dashboard ';\n    const redirectOnError = () =>\n    process.browser\n        ? Router.push('/authorsArea')\n        : ctx.res.writeHead(301, { Location: '/authorsArea' })\n    if (logintoken) {\n        try {\n            // console.log({logintoken}, 'getIProps right before fetch call')\n            const response = await fetch(apiUrl, {\n                credentials: 'include',\n                cache: 'no-cache',\n                headers: {\n                    Authorization: 'Bearer ' + logintoken,\n                }\n            })\n            const data = await response.json()\n            // console.log('Authors response Data =>', data.status, data);\n            if (data.status === 'success') {\n                console.log('res.ok', data)\n                return { authorData: data }\n            }\n            else {\n                console.log('not reading success')\n                // https://github.com/developit/unfetch#caveats\n                return redirectOnError()\n            }\n        } catch (error) {\n            // Implementation or Network error\n            console.log(error)\n            return redirectOnError()\n        }\n    }\n    // return {}\n\n}\n\nexport default withAuthSync(AuthorsAreaDash)\n// export default AuthorsArea;\n\n\n// !\n// ?\n// *\n// todo\n{/* <div className=\"form-container\">\n                <form>\n                {this.state.hasForm &&\n                \n\n              this.state.formdata.map(component => {\n                 return(\n                        <div className=\"form-item\">\n                        {component.title ? <title>{component.title}</title> : null }\n                        {component.type ? \n                        <label>\n                        {component.options ? null : component.label}\n                        <input\n                        required={component.options ?  null : component.required ? component.required : null}\n                         name={component.name}\n                         type={component.type}\n                         value={this.state.name}\n                         onChange={this.handleInputChange}\n                        /> \n                        </label>\n                        : null\n                        }\n                        {component.options ? \n                        <label>\n                            {component.label}\n                        <select name={component.name} >\n                            {component.options.map( option => {\n                                return( \n                                        <option value={option.value}>{option.label}</option>\n                                )\n                            })}\n                        </select> \n                        </label>    \n                        : null}\n                        {component.default ? <default>{component.default}</default> : null}\n\n                        </div>\n                 )\n                    }\n                )\n                }\n                </form>\n                </div> */}\n// //"]},"metadata":{},"sourceType":"module"}