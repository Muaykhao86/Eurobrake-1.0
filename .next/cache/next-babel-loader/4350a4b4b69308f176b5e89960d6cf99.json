{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/mnt/c/Users/D.Hardiman/desktop/eurobrake/pages/f/[id]/[formType].js\";\nvar __jsx = React.createElement;\nimport React, { Component } from 'react';\nimport cookies from 'next-cookies';\nimport Router from 'next/router';\nimport fetch from 'isomorphic-unfetch';\nimport Link from 'next/link';\nimport OneForm from '../../../components/forms/OneForm';\nimport { LoginForm } from '../../../components/forms/LoginForm';\nimport { Button } from '../../../components/Button';\nimport { AbstractForm } from '../../../components/forms/Abstract';\nimport { Authorprofile } from '../../../components/forms/Authorprofile';\nimport { Exhibitorprofile } from '../../../components/forms/Exhibitorprofile';\nimport { StyledPage } from '../../../components/styles/PageStyles';\nimport HeroSection from '../../../components/HeroSection';\nimport { FixedDates } from '../../../components/Dates'; // import { Esop } from './Esop';\n// import { GetFormSSR } from '../../components/forms/FormActions';\n\nvar Form = function Form(props) {\n  var _ref = props.data || {},\n      presets = _ref.presets,\n      __csrf_token = _ref.__csrf_token;\n\n  var apiUrl = props.apiUrl,\n      id = props.id,\n      formType = props.formType,\n      taskType = props.taskType; // ? GETTIN FROM GET INITIAL PROPS\n\n  var FT = formType || '';\n  var TT = taskType || '';\n  console.log({\n    apiUrl: apiUrl,\n    id: id,\n    FT: FT,\n    TT: TT\n  });\n  return __jsx(React.Fragment, null, __jsx(HeroSection, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 25\n    },\n    __self: this\n  }, \"Eurobrake 2020\"), __jsx(StyledPage, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 28\n    },\n    __self: this\n  }, __jsx(FixedDates, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29\n    },\n    __self: this\n  }), __jsx(Link, {\n    href: \"/authorsAreaDash\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30\n    },\n    __self: this\n  }, __jsx(Button, {\n    background: \"#134381\",\n    br: \"100rem\",\n    bcolor: \"#134381\",\n    style: {\n      marginLeft: 'auto',\n      color: \"#FFF\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31\n    },\n    __self: this\n  }, \"Back to Dashboard\")), __jsx(OneForm, {\n    form: FT,\n    type: TT,\n    presets: presets,\n    csrf: __csrf_token,\n    apiUrl: apiUrl,\n    paperId: id,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38\n    },\n    __self: this\n  })));\n};\n\nexport default Form;\n\nForm.getInitialProps =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(context) {\n    var _context$query, id, taskUrl, formType, taskType, _ref3, logintoken, apiUrl, redirectOnError, response, data;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context$query = context.query, id = _context$query.id, taskUrl = _context$query.taskUrl, formType = _context$query.formType, taskType = _context$query.taskType;\n            _ref3 = cookies(context) || {}, logintoken = _ref3.logintoken;\n            apiUrl = '';\n            if (formType == 'author') apiUrl = \"https://prelude.eurobrake.net/authors/profile\";\n            if (formType == 'reset') apiUrl = \"https://prelude.eurobrake.net/authors/profile\";\n            if (formType != 'reset' && formType != 'author') apiUrl = \"https://prelude.eurobrake.net/authors/edit/\".concat(id);\n            console.log('1st GIP', {\n              id: id,\n              logintoken: logintoken,\n              apiUrl: apiUrl,\n              taskUrl: taskUrl,\n              formType: formType,\n              taskType: taskType\n            });\n            console.log('props', {\n              id: id,\n              logintoken: logintoken,\n              apiUrl: apiUrl,\n              taskUrl: taskUrl,\n              formType: formType,\n              taskType: taskType\n            });\n\n            redirectOnError = function redirectOnError() {\n              return process.browser ? Router.push('/authorsArea') : context.res.writeHead(301, {\n                Location: '/authorsArea'\n              });\n            };\n\n            if (!(formType === 'reset')) {\n              _context.next = 13;\n              break;\n            }\n\n            return _context.abrupt(\"return\", {\n              apiUrl: apiUrl,\n              id: id,\n              formType: formType,\n              taskType: taskType\n            });\n\n          case 13:\n            if (!logintoken) {\n              _context.next = 37;\n              break;\n            }\n\n            _context.prev = 14;\n            _context.next = 17;\n            return fetch(apiUrl, {\n              credentials: 'include',\n              cache: 'no-cache',\n              headers: {\n                Authorization: 'Bearer ' + logintoken\n              }\n            });\n\n          case 17:\n            response = _context.sent;\n            _context.next = 20;\n            return response.json();\n\n          case 20:\n            data = _context.sent;\n\n            if (!(data.status === 'success')) {\n              _context.next = 26;\n              break;\n            }\n\n            console.log('res.ok 2nd GIP', data);\n            return _context.abrupt(\"return\", {\n              data: data,\n              apiUrl: apiUrl,\n              id: id,\n              formType: formType,\n              taskType: taskType\n            });\n\n          case 26:\n            console.log('not reading success');\n            console.log('stringyfied', _JSON$stringify(data)); // https://github.com/developit/unfetch#caveats\n\n            return _context.abrupt(\"return\", redirectOnError());\n\n          case 29:\n            _context.next = 37;\n            break;\n\n          case 31:\n            _context.prev = 31;\n            _context.t0 = _context[\"catch\"](14);\n            // Implementation or Network error\n            console.log(_context.t0);\n            _context.next = 36;\n            return redirectOnError();\n\n          case 36:\n            return _context.abrupt(\"return\", _context.sent);\n\n          case 37:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[14, 31]]);\n  }));\n\n  return function (_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();","map":{"version":3,"sources":["/mnt/c/Users/D.Hardiman/desktop/eurobrake/pages/f/[id]/[formType].js"],"names":["React","Component","cookies","Router","fetch","Link","OneForm","LoginForm","Button","AbstractForm","Authorprofile","Exhibitorprofile","StyledPage","HeroSection","FixedDates","Form","props","data","presets","__csrf_token","apiUrl","id","formType","taskType","FT","TT","console","log","marginLeft","color","getInitialProps","context","query","taskUrl","logintoken","redirectOnError","process","browser","push","res","writeHead","Location","credentials","cache","headers","Authorization","response","json","status"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport cookies from 'next-cookies';\nimport Router from 'next/router';\nimport fetch from 'isomorphic-unfetch';\nimport Link from 'next/link';\nimport OneForm from '../../../components/forms/OneForm';\nimport { LoginForm } from '../../../components/forms/LoginForm';\nimport { Button } from '../../../components/Button';\nimport { AbstractForm } from '../../../components/forms/Abstract';\nimport { Authorprofile } from '../../../components/forms/Authorprofile';\nimport { Exhibitorprofile } from '../../../components/forms/Exhibitorprofile';\nimport { StyledPage } from '../../../components/styles/PageStyles';\nimport HeroSection from '../../../components/HeroSection';\nimport {FixedDates} from '../../../components/Dates';\n// import { Esop } from './Esop';\n// import { GetFormSSR } from '../../components/forms/FormActions';\nconst Form = props => {\n    const { presets, __csrf_token, } = props.data || {};\n    const {apiUrl, id, formType, taskType} = props;// ? GETTIN FROM GET INITIAL PROPS\n    const FT = formType || '';\n    const TT = taskType || '';\n    console.log({apiUrl, id, FT, TT})\n    return (\n        <>\n        <HeroSection>\n            Eurobrake 2020\n            </HeroSection>\n        <StyledPage>\n            <FixedDates/>\n            <Link href=\"/authorsAreaDash\">\n                          <Button\n                        background=\"#134381\"\n                        br=\"100rem\"\n                        bcolor=\"#134381\"\n                        style={{ marginLeft: 'auto', color:\"#FFF\" }}\n                    >Back to Dashboard</Button>\n            </Link>\n            <OneForm form={FT} type={TT} presets={presets} csrf={__csrf_token} apiUrl={apiUrl} paperId={id}/>\n    </StyledPage>\n        </>\n    )\n}\nexport default Form\nForm.getInitialProps = async context => {\n    const { id, taskUrl, formType, taskType } = context.query ;\n    const { logintoken } = cookies(context) || {};\n    let apiUrl = '';\n    \n   if(formType == 'author') apiUrl = `https://prelude.eurobrake.net/authors/profile` \n   if(formType == 'reset') apiUrl = `https://prelude.eurobrake.net/authors/profile` \n   if(formType != 'reset' && formType != 'author') apiUrl = `https://prelude.eurobrake.net/authors/edit/${id}`\n   \n    console.log('1st GIP', { id, logintoken, apiUrl, taskUrl, formType, taskType })\n    console.log('props', { id, logintoken, apiUrl, taskUrl, formType, taskType })\n    const redirectOnError = () =>\n        process.browser\n            ? Router.push('/authorsArea')\n            : context.res.writeHead(301, { Location: '/authorsArea' })\n\n    if(formType === 'reset') return { apiUrl, id, formType, taskType}\n   \n   else if (logintoken) {\n        try {\n            const response = await fetch(apiUrl, {\n                credentials: 'include',\n                cache: 'no-cache',\n                headers: {\n                    Authorization: 'Bearer ' + logintoken,\n                }\n            })\n            const data = await response.json()\n            if (data.status === 'success') {\n                console.log('res.ok 2nd GIP', data)\n                return { data, apiUrl, id, formType, taskType }\n            }\n            else {\n                console.log('not reading success')\n                console.log('stringyfied', JSON.stringify(data))\n                // https://github.com/developit/unfetch#caveats\n                return redirectOnError()\n            }\n        } catch (error) {\n            // Implementation or Network error\n            console.log(error)\n            return await redirectOnError()\n        }\n    \n    }     \n}\n   "]},"metadata":{},"sourceType":"module"}