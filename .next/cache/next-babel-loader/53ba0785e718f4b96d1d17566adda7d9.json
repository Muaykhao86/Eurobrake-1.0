{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/mnt/c/Users/D.Hardiman/desktop/eurobrake/pages/login.js\";\nvar __jsx = React.createElement;\nimport React, { Component } from 'react';\nimport styled from 'styled-components';\nimport fetch from 'isomorphic-unfetch';\nimport { login } from '../utils/auth';\nconst DemoDiv = styled.form.withConfig({\n  displayName: \"login__DemoDiv\",\n  componentId: \"cxdurq-0\"\n})([\"display:flex;flex-direction:column;align-self:center;max-width:\", \";\"], props => props.theme.maxWidth);\nconst Demo = styled.h1.withConfig({\n  displayName: \"login__Demo\",\n  componentId: \"cxdurq-1\"\n})([\"padding:10rem;margin:5rem;color:orangered;\"]);\nexport default class Login extends Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"saveToState\", e => {\n      this.setState({\n        [e.target.name]: e.target.value\n      });\n    });\n\n    _defineProperty(this, \"onSubmit\", async e => {\n      e.preventDefault();\n      console.log('click');\n      const {\n        authorLogin,\n        username,\n        password,\n        error\n      } = this.state;\n      const apiUrl = authorLogin ? 'https://prelude.eurobrake.net/login' : ''; // action=\"//2019.eurobrake.net/exhibition/exhibitors/login\" SHOULD BE LOGIN FORM FOR EXHIBITORS\n\n      const formData = {\n        username: username,\n        password: password\n      };\n\n      try {\n        const response = await fetch(apiUrl, {\n          method: 'POST',\n          credentials: 'include',\n          body: _JSON$stringify(formData)\n        });\n        console.log(response);\n\n        if (response.status === 200) {\n          const {\n            logintoken\n          } = await response.json();\n          console.log({\n            logintoken\n          });\n          await login({\n            logintoken\n          });\n        } else {\n          console.log('login failed');\n          let error = new Error(response.statusText);\n          error.response = response;\n          throw error;\n        }\n      } catch (error) {\n        console.error('Failed to login, please try again', error);\n        this.setState({\n          error: error.message\n        });\n      }\n    });\n\n    this.state = {\n      username: '',\n      password: '',\n      authorLogin: true,\n      error: ''\n    };\n  }\n\n  render() {\n    console.log(this.props);\n    const {\n      form\n    } = this.props.form;\n    return __jsx(DemoDiv, {\n      onSubmit: this.onSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, __jsx(Demo, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, __jsx(\"label\", {\n      htmlFor: \"label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, form[0].label), __jsx(\"input\", {\n      type: \"text\",\n      name: form[0].name,\n      onChange: this.saveToState,\n      value: this.state.username,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    })), __jsx(\"div\", {\n      className: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, __jsx(\"label\", {\n      htmlFor: \"label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, form[1].label), __jsx(\"input\", {\n      type: \"password\",\n      name: form[1].name,\n      onChange: this.saveToState,\n      value: this.state.password,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }))), __jsx(\"input\", {\n      type: \"submit\",\n      value: \"Submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }));\n  }\n\n} // !!! NOTE IF I GO TO '/' IT GETS RID OF THE LOGGED IN COOKIE !!!\n\n_defineProperty(Login, \"getInitialProps\", async function () {\n  const res = await fetch('https://prelude.eurobrake.net/login');\n  const data = await res.json().catch(error => console.log(error));\n  ;\n  return {\n    form: data\n  };\n});","map":{"version":3,"sources":["/mnt/c/Users/D.Hardiman/desktop/eurobrake/pages/login.js"],"names":["React","Component","styled","fetch","login","DemoDiv","form","props","theme","maxWidth","Demo","h1","Login","constructor","e","setState","target","name","value","preventDefault","console","log","authorLogin","username","password","error","state","apiUrl","formData","response","method","credentials","body","status","logintoken","json","Error","statusText","message","render","onSubmit","label","saveToState","res","data","catch"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport styled from 'styled-components';\nimport fetch from 'isomorphic-unfetch';\nimport { login } from '../utils/auth';\n\n\n\nconst DemoDiv = styled.form`\n    display: flex;\n    flex-direction: column;\n    align-self: center; \n    max-width: ${props => props.theme.maxWidth};\n`;\n\n\nconst Demo = styled.h1`\n    padding: 10rem;\n    margin: 5rem;\n    color: orangered;\n\n`;\n\n\n\nexport default class Login extends Component {\n    static getInitialProps = async function () {\n        const res = await fetch('https://prelude.eurobrake.net/login');\n        const data = await res.json().catch(error => console.log(error));;\n        return {\n            form: data\n        };\n    };\n\n   \nconstructor(props) {\n    super(props);\n    this.state={\n        username: '',\n        password: '',\n        authorLogin: true,\n        error: ''\n    }\n}\n\n    saveToState = (e) => {\n        this.setState({ [e.target.name]: e.target.value });\n    }\n   \n\n    onSubmit = async (e) =>{\n    e.preventDefault()\n    console.log('click');\n        \n    const {authorLogin, username, password, error} = this.state;\n    const apiUrl = authorLogin ? 'https://prelude.eurobrake.net/login' : '' ;\n// action=\"//2019.eurobrake.net/exhibition/exhibitors/login\" SHOULD BE LOGIN FORM FOR EXHIBITORS\n        \n        const formData = {\n            username: username,\n            password: password,\n        }\n\n    try{\n\n        const response = await fetch(apiUrl, {\n                method: 'POST',\n                credentials: 'include',\n                body: JSON.stringify(formData)\n            });\n        console.log(response)\n        if(response.status === 200) {\n        const {logintoken} = await response.json()\n        console.log({logintoken})\n        await login({logintoken})\n    }else{\n        console.log('login failed')\n        let error = new Error(response.statusText)\n        error.response = response\n       throw error\n        }\n    }catch (error){\n        console.error(\n            'Failed to login, please try again', error\n            )\n       this.setState({error: error.message});\n    }\n\n}\n\n\nrender(){\n  console.log(this.props)\n    const {form} = this.props.form;\n        return (\n         <DemoDiv onSubmit={this.onSubmit}>\n            <Demo>\n\n            <div className=\"\">\n                <label htmlFor=\"label\">{form[0].label}</label>\n                <input type=\"text\" name={form[0].name} onChange={this.saveToState} value={this.state.username}/>\n            </div>\n            <div className=\"\">    \n                <label htmlFor=\"label\">{form[1].label}</label>\n                <input type=\"password\" name={form[1].name} onChange={this.saveToState} value={this.state.password}/>\n            </div>\n            </Demo>\n            <input type=\"submit\" value=\"Submit\"/>\n        </DemoDiv>\n        )\n    }\n}\n\n\n\n// !!! NOTE IF I GO TO '/' IT GETS RID OF THE LOGGED IN COOKIE !!!"]},"metadata":{},"sourceType":"module"}