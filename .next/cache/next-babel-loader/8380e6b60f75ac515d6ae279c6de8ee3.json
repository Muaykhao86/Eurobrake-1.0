{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport cookie from 'js-cookie';\nimport cookies from 'next-cookies';\nimport fetch from 'isomorphic-unfetch';\nimport { login } from '../../utils/auth';\nexport function GetFormSSR(_x) {\n  return _GetFormSSR.apply(this, arguments);\n}\n\nfunction _GetFormSSR() {\n  _GetFormSSR = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(_ref) {\n    var url, context, _cookies, logintoken, apiUrl, response, data, error;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            url = _ref.url, context = _ref.context;\n            // use `nextCookie` to get the cookie and pass the token to the frontend in the `props`.\n            _cookies = cookies(context), logintoken = _cookies.logintoken;\n            console.log({\n              logintoken: logintoken\n            });\n            _context.prev = 3;\n            apiUrl = url;\n            _context.next = 7;\n            return fetch(apiUrl, {\n              credentials: 'include',\n              cache: 'no-cache',\n              headers: {\n                Authorization: 'Bearer ' + logintoken\n              }\n            });\n\n          case 7:\n            response = _context.sent;\n            _context.next = 10;\n            return response.json();\n\n          case 10:\n            data = _context.sent;\n\n            if (!(data.status === 'success')) {\n              _context.next = 17;\n              break;\n            }\n\n            console.log('getForm', data);\n            console.log('tkn', data.__csrf_token);\n            return _context.abrupt(\"return\", data);\n\n          case 17:\n            error = new Error(data.error);\n            error.response = response;\n            throw error;\n\n          case 20:\n            _context.next = 26;\n            break;\n\n          case 22:\n            _context.prev = 22;\n            _context.t0 = _context[\"catch\"](3);\n            console.error('Failed to get form, please try again', _context.t0);\n            return _context.abrupt(\"return\", _context.t0);\n\n          case 26:\n            return _context.abrupt(\"return\");\n\n          case 27:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[3, 22]]);\n  }));\n  return _GetFormSSR.apply(this, arguments);\n}\n\nexport function GetForm(_x2) {\n  return _GetForm.apply(this, arguments);\n}\n\nfunction _GetForm() {\n  _GetForm = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(url) {\n    var _cookie$get, logintoken, apiUrl, response, data, error;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _cookie$get = cookie.get(), logintoken = _cookie$get.logintoken;\n            console.log({\n              logintoken: logintoken\n            });\n            _context2.prev = 2;\n            apiUrl = url;\n            _context2.next = 6;\n            return fetch(apiUrl, {\n              credentials: 'include',\n              cache: 'no-cache',\n              headers: {\n                Authorization: 'Bearer ' + logintoken\n              }\n            });\n\n          case 6:\n            response = _context2.sent;\n            _context2.next = 9;\n            return response.json();\n\n          case 9:\n            data = _context2.sent;\n\n            if (!(data.status === 'success')) {\n              _context2.next = 16;\n              break;\n            }\n\n            console.log('getForm', data);\n            console.log('tkn', data.__csrf_token);\n            return _context2.abrupt(\"return\", data);\n\n          case 16:\n            error = new Error(data.error);\n            error.response = response;\n            throw error;\n\n          case 19:\n            _context2.next = 25;\n            break;\n\n          case 21:\n            _context2.prev = 21;\n            _context2.t0 = _context2[\"catch\"](2);\n            console.error('Failed to get form, please try again', _context2.t0);\n            return _context2.abrupt(\"return\", _context2.t0);\n\n          case 25:\n            return _context2.abrupt(\"return\");\n\n          case 26:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[2, 21]]);\n  }));\n  return _GetForm.apply(this, arguments);\n}\n\nexport function SendFile(_x3) {\n  return _SendFile.apply(this, arguments);\n}\n\nfunction _SendFile() {\n  _SendFile = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee3(_ref2) {\n    var values, url, csrf, _cookie$get2, logintoken, formData, apiUrl, response, data, error;\n\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            values = _ref2.values, url = _ref2.url, csrf = _ref2.csrf;\n            _cookie$get2 = cookie.get(), logintoken = _cookie$get2.logintoken;\n            formData = new FormData();\n            values.accept && values.accept === true ? values.accept = 'yes' : null;\n            values.copyright && values.copyright === true ? values.copyright = 'yes' : null;\n\n            _Object$keys(values).forEach(function (key) {\n              formData.append(key, values[key]);\n            });\n\n            console.log({\n              logintoken: logintoken,\n              url: url\n            });\n\n            if (!(logintoken && csrf)) {\n              _context3.next = 33;\n              break;\n            }\n\n            _context3.prev = 8;\n            apiUrl = url;\n            _context3.next = 12;\n            return fetch(apiUrl, {\n              method: 'POST',\n              body: formData,\n              credentials: 'include',\n              headers: {\n                Authorization: 'Bearer ' + logintoken\n              }\n            });\n\n          case 12:\n            response = _context3.sent;\n            _context3.next = 15;\n            return response.json();\n\n          case 15:\n            data = _context3.sent;\n            _context3.next = 18;\n            return console.log({\n              data: data\n            });\n\n          case 18:\n            if (!(data.status === 'success')) {\n              _context3.next = 23;\n              break;\n            }\n\n            console.log('getForm', data);\n            return _context3.abrupt(\"return\", data);\n\n          case 23:\n            error = new Error(data.error);\n            error.response = response;\n            throw error;\n\n          case 26:\n            _context3.next = 33;\n            break;\n\n          case 28:\n            _context3.prev = 28;\n            _context3.t0 = _context3[\"catch\"](8);\n            console.error('Failed to get form, please try again', _context3.t0);\n            this.setState({\n              error: _context3.t0.message\n            });\n            return _context3.abrupt(\"return\", _context3.t0);\n\n          case 33:\n            return _context3.abrupt(\"return\");\n\n          case 34:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, this, [[8, 28]]);\n  }));\n  return _SendFile.apply(this, arguments);\n}\n\nexport function SendForm(_x4) {\n  return _SendForm.apply(this, arguments);\n}\n\nfunction _SendForm() {\n  _SendForm = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee4(_ref3) {\n    var csrf, values, url, FT, form, _cookie$get3, logintoken, apiUrl, response, data, error, _response, _data, _logintoken, _error, _response2, _data2, _error2, _response3, _data3, _error3, _response4, _data4, _error4;\n\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            csrf = _ref3.csrf, values = _ref3.values, url = _ref3.url, FT = _ref3.FT;\n            values && values.accept && values.accept === true ? values.accept = 'yes' : null;\n            values && values.copyright && values.copyright === true ? values.copyright = 'yes' : null;\n            form = _JSON$stringify(values);\n            _cookie$get3 = cookie.get(), logintoken = _cookie$get3.logintoken;\n            console.log({\n              url: url,\n              form: form,\n              FT: FT,\n              csrf: csrf\n            });\n\n            if (!(logintoken && csrf && form)) {\n              _context4.next = 29;\n              break;\n            }\n\n            _context4.prev = 7;\n            apiUrl = url;\n            _context4.next = 11;\n            return fetch(apiUrl, {\n              method: 'POST',\n              body: form,\n              credentials: 'include',\n              headers: {\n                Authorization: 'Bearer ' + logintoken,\n                'Content-Type': 'application/json'\n              }\n            });\n\n          case 11:\n            response = _context4.sent;\n            _context4.next = 14;\n            return response.json();\n\n          case 14:\n            data = _context4.sent;\n\n            if (!(data.status === 'success')) {\n              _context4.next = 20;\n              break;\n            }\n\n            console.log('getForm', data);\n            return _context4.abrupt(\"return\", data);\n\n          case 20:\n            error = new Error(data.error);\n            error.response = response;\n            throw error;\n\n          case 23:\n            _context4.next = 29;\n            break;\n\n          case 25:\n            _context4.prev = 25;\n            _context4.t0 = _context4[\"catch\"](7);\n            console.error('Failed to send form, please try again', _context4.t0);\n            return _context4.abrupt(\"return\", _context4.t0);\n\n          case 29:\n            if (!(url === 'https://prelude.eurobrake.net/authors/login')) {\n              _context4.next = 54;\n              break;\n            }\n\n            console.log({\n              url: url,\n              form: form\n            });\n            _context4.prev = 31;\n            _context4.next = 34;\n            return fetch(url, {\n              method: 'POST',\n              credentials: 'include',\n              body: form,\n              headers: {\n                'Content-Type': 'application/json'\n              }\n            });\n\n          case 34:\n            _response = _context4.sent;\n            _context4.next = 37;\n            return _response.json();\n\n          case 37:\n            _data = _context4.sent;\n\n            if (!(_data.status === 'success')) {\n              _context4.next = 45;\n              break;\n            }\n\n            _logintoken = _data.logintoken;\n            _context4.next = 42;\n            return login({\n              logintoken: _logintoken\n            });\n\n          case 42:\n            return _context4.abrupt(\"return\", _data);\n\n          case 45:\n            _error = new Error(_data.error);\n            _error.response = _response;\n            throw _error;\n\n          case 48:\n            _context4.next = 54;\n            break;\n\n          case 50:\n            _context4.prev = 50;\n            _context4.t1 = _context4[\"catch\"](31);\n            console.error('Failed to login, please try again', _context4.t1);\n            return _context4.abrupt(\"return\", _context4.t1);\n\n          case 54:\n            if (!(FT === 'reset')) {\n              _context4.next = 77;\n              break;\n            }\n\n            console.log({\n              url: url,\n              form: form\n            });\n            _context4.prev = 56;\n            _context4.next = 59;\n            return fetch(url, {\n              method: 'POST',\n              credentials: 'include',\n              body: form,\n              headers: {\n                'Content-Type': 'application/json'\n              }\n            });\n\n          case 59:\n            _response2 = _context4.sent;\n            _context4.next = 62;\n            return _response2.json();\n\n          case 62:\n            _data2 = _context4.sent;\n\n            if (!(_data2.status === 'success')) {\n              _context4.next = 68;\n              break;\n            }\n\n            console.log('getForm', _data2);\n            return _context4.abrupt(\"return\", _data2);\n\n          case 68:\n            _error2 = new Error(_data2.error);\n            _error2.response = _response2;\n            throw _error2;\n\n          case 71:\n            _context4.next = 77;\n            break;\n\n          case 73:\n            _context4.prev = 73;\n            _context4.t2 = _context4[\"catch\"](56);\n            console.error('Failed to reset, please try again', _context4.t2);\n            return _context4.abrupt(\"return\", _context4.t2);\n\n          case 77:\n            if (!(FT === 'newsletter' || FT === 'contact')) {\n              _context4.next = 100;\n              break;\n            }\n\n            console.log({\n              url: url,\n              form: form\n            });\n            _context4.prev = 79;\n            _context4.next = 82;\n            return fetch(url, {\n              method: 'POST',\n              credentials: 'include',\n              body: form,\n              headers: {\n                'Content-Type': 'application/json'\n              }\n            });\n\n          case 82:\n            _response3 = _context4.sent;\n            _context4.next = 85;\n            return _response3.json();\n\n          case 85:\n            _data3 = _context4.sent;\n\n            if (!(_data3.status === 'success')) {\n              _context4.next = 91;\n              break;\n            }\n\n            console.log('getForm', _data3);\n            return _context4.abrupt(\"return\", _data3);\n\n          case 91:\n            _error3 = new Error(_data3.error);\n            _error3.response = _response3;\n            throw _error3;\n\n          case 94:\n            _context4.next = 100;\n            break;\n\n          case 96:\n            _context4.prev = 96;\n            _context4.t3 = _context4[\"catch\"](79);\n            console.error('Failed to send form, please try again', _context4.t3);\n            return _context4.abrupt(\"return\", _context4.t3);\n\n          case 100:\n            if (!(FT === 'withdraw')) {\n              _context4.next = 123;\n              break;\n            }\n\n            console.log({\n              url: url\n            });\n            _context4.prev = 102;\n            _context4.next = 105;\n            return fetch(url, {\n              method: 'POST',\n              credentials: 'include',\n              headers: {\n                Authorization: 'Bearer ' + logintoken,\n                'Content-Type': 'application/json'\n              }\n            });\n\n          case 105:\n            _response4 = _context4.sent;\n            _context4.next = 108;\n            return _response4.json();\n\n          case 108:\n            _data4 = _context4.sent;\n\n            if (!(_data4.status === 'success')) {\n              _context4.next = 114;\n              break;\n            }\n\n            console.log('getForm', _data4);\n            return _context4.abrupt(\"return\", _data4);\n\n          case 114:\n            _error4 = new Error(_data4.error);\n            _error4.response = _response4;\n            throw _error4;\n\n          case 117:\n            _context4.next = 123;\n            break;\n\n          case 119:\n            _context4.prev = 119;\n            _context4.t4 = _context4[\"catch\"](102);\n            console.error('Failed to withdraw, please try again', _context4.t4);\n            return _context4.abrupt(\"return\", _context4.t4);\n\n          case 123:\n            return _context4.abrupt(\"return\");\n\n          case 124:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4, null, [[7, 25], [31, 50], [56, 73], [79, 96], [102, 119]]);\n  }));\n  return _SendForm.apply(this, arguments);\n}","map":{"version":3,"sources":["/mnt/c/Users/D.Hardiman/desktop/eurobrake/components/forms/FormActions.js"],"names":["cookie","cookies","fetch","login","GetFormSSR","url","context","logintoken","console","log","apiUrl","credentials","cache","headers","Authorization","response","json","data","status","__csrf_token","error","Error","GetForm","get","SendFile","values","csrf","formData","FormData","accept","copyright","forEach","key","append","method","body","setState","message","SendForm","FT","form"],"mappings":"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","sourcesContent":["import cookie from 'js-cookie';\nimport cookies from 'next-cookies';\nimport fetch from 'isomorphic-unfetch';\nimport { login} from '../../utils/auth';\n\n\nexport async function GetFormSSR({url, context}) {\n    // use `nextCookie` to get the cookie and pass the token to the frontend in the `props`.\n    const { logintoken } = cookies(context);\n    console.log({logintoken})\n    try {\n        const apiUrl = url;\n        const response = await fetch(apiUrl, {\n            credentials: 'include',\n            cache: 'no-cache',\n            headers: {\n                Authorization: 'Bearer ' + logintoken,\n            }\n        });\n        const data = await response.json();\n        if (data.status === 'success') {\n            console.log('getForm', data);\n            console.log('tkn', data.__csrf_token)\n            return data;\n        } else {\n            let error = new Error(data.error)\n            error.response = response\n            throw error\n        }\n    } catch (error) {\n        console.error(\n            'Failed to get form, please try again', error\n        )\n        return error\n    }\n    return\n}\n\nexport async function GetForm(url) {\n    const { logintoken } = cookie.get();\n    console.log({ logintoken })\n    try {\n        const apiUrl = url;\n        const response = await fetch(apiUrl, {\n            credentials: 'include',\n             cache: 'no-cache',\n            headers: {\n                Authorization: 'Bearer ' + logintoken,\n            }\n        });\n        const data = await response.json();\n        if (data.status === 'success') {\n            console.log('getForm', data);\n            console.log('tkn', data.__csrf_token)\n            return data;\n        } else {\n            let error = new Error(data.error)\n            error.response = response\n            throw error\n        }\n    } catch (error) {\n        console.error(\n            'Failed to get form, please try again', error\n        )\n        return error\n    }\n    return \n}\n\nexport async function SendFile({ values, url, csrf }) {\n    const { logintoken } = cookie.get();\n    const formData = new FormData();\n    values.accept && values.accept === true ? values.accept = 'yes' : null;\n    values.copyright && values.copyright === true ? values.copyright = 'yes' : null;\n    \n    Object.keys(values).forEach(key => {   \n      formData.append(key, values[key])});\n    \n  \n    console.log({ logintoken,  url})\n    if (logintoken && csrf ) {\n        try {\n            const apiUrl = url;\n            const response = await fetch(apiUrl, {\n                method: 'POST',\n                body: formData,\n                credentials: 'include',\n                headers: {\n                    Authorization: 'Bearer ' + logintoken,\n                }\n            });\n            const data = await response.json();\n            await console.log({ data })\n            if (data.status === 'success') {\n                console.log('getForm', data);\n                return data\n\n            } else {\n                let error = new Error(data.error)\n                error.response = response\n                throw error\n            }\n        } catch (error) {\n            console.error(\n                'Failed to get form, please try again', error\n            )\n            this.setState({ error: error.message });\n            return error\n        }\n    }\n\n    return\n}\n\n\nexport async function SendForm({ csrf, values, url, FT }) {\n     values && values.accept && values.accept === true ? values.accept = 'yes' : null;\n    values && values.copyright && values.copyright === true ? values.copyright = 'yes' : null;\n    const form = JSON.stringify(values);\n    const { logintoken } = cookie.get();\n        console.log({url, form, FT, csrf});\n    if (logintoken && csrf && form) {\n        try {\n            const apiUrl = url;\n            const response = await fetch(apiUrl, {\n                method: 'POST', \n                body: form,\n                credentials: 'include',\n                headers: {\n                    Authorization: 'Bearer ' + logintoken,\n                    'Content-Type': 'application/json'\n                }\n            });\n            const data = await response.json();\n            if (data.status === 'success') {\n                console.log('getForm', data);\n                return data\n            } else {\n                let error = new Error(data.error)\n                error.response = response   \n                throw error\n            }\n        } catch (error) {\n            console.error(\n                'Failed to send form, please try again', error\n            )\n            return error\n        }\n    }\n    if(url === 'https://prelude.eurobrake.net/authors/login' ){\n        console.log({url, form});\n        try {\n            const response = await fetch(url, {\n                method: 'POST', \n                credentials: 'include',\n                body: form,\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n            });\n         \n            const data = await response.json()\n\n            if (data.status === 'success') {\n                const { logintoken } = data;\n                await login({ logintoken })\n                return data\n\n            } else {\n                let error = new Error(data.error)\n                error.response = response\n                throw error\n            }\n        } catch (error) {\n            console.error(\n                'Failed to login, please try again', error\n            )\n            return error\n         }\n        }\n    if(FT === 'reset' ){\n        console.log({url, form});\n        try {\n            const response = await fetch(url, {\n                method: 'POST', \n                credentials: 'include',\n                body: form,\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n            });\n         \n            const data = await response.json()\n\n            if (data.status === 'success') {\n            console.log('getForm', data);\n            return data\n\n            } else {\n                let error = new Error(data.error)\n                error.response = response\n                throw error\n            }\n        } catch (error) {\n            console.error(\n                'Failed to reset, please try again', error\n            )\n            return error\n         }\n        }\n    if(FT === 'newsletter' || FT === 'contact'){\n        console.log({url, form});\n        try {\n            const response = await fetch(url, {\n                method: 'POST', \n                credentials: 'include',\n                body: form,\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n            });\n         \n            const data = await response.json()\n\n            if (data.status === 'success') {\n            console.log('getForm', data);\n            return data\n\n            } else {\n                let error = new Error(data.error)\n                error.response = response\n                throw error\n            }\n        } catch (error) {\n            console.error(\n                'Failed to send form, please try again', error\n            )\n            return error\n         }\n        }\n    if(FT === 'withdraw' ){\n        console.log({url});\n        try {\n            const response = await fetch(url, {\n                method: 'POST', \n                credentials: 'include',\n                headers: {\n                    Authorization: 'Bearer ' + logintoken,\n                    'Content-Type': 'application/json'\n                },\n            });\n         \n            const data = await response.json()\n\n            if (data.status === 'success') {\n            console.log('getForm', data);\n            return data\n\n            } else {\n                let error = new Error(data.error)\n                error.response = response\n                throw error\n            }\n        } catch (error) {\n            console.error(\n                'Failed to withdraw, please try again', error\n            )\n            return error\n         }\n        }\n    return\n    }\n\n"]},"metadata":{},"sourceType":"module"}