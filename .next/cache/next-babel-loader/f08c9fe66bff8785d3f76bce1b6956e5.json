{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport cookie from 'js-cookie';\nexport function GetForm(_x) {\n  return _GetForm.apply(this, arguments);\n}\n\nfunction _GetForm() {\n  _GetForm = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(url) {\n    var _cookie$get, logintoken, apiUrl, response, data, error;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _cookie$get = cookie.get(), logintoken = _cookie$get.logintoken;\n            console.log({\n              logintoken: logintoken\n            });\n            _context.prev = 2;\n            apiUrl = url;\n            _context.next = 6;\n            return fetch(apiUrl, {\n              credentials: 'include',\n              headers: {\n                Authorization: 'Bearer ' + logintoken\n              }\n            });\n\n          case 6:\n            response = _context.sent;\n            _context.next = 9;\n            return response.json();\n\n          case 9:\n            data = _context.sent;\n\n            if (!(data.status === 'success')) {\n              _context.next = 16;\n              break;\n            }\n\n            console.log('getForm', data);\n            console.log('tkn', data.__csrf_token);\n            return _context.abrupt(\"return\", data);\n\n          case 16:\n            error = new Error(data.error);\n            error.response = response;\n            throw error;\n\n          case 19:\n            _context.next = 24;\n            break;\n\n          case 21:\n            _context.prev = 21;\n            _context.t0 = _context[\"catch\"](2);\n            console.error('Failed to get form, please try again', _context.t0); // return error.message\n\n          case 24:\n            return _context.abrupt(\"return\");\n\n          case 25:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[2, 21]]);\n  }));\n  return _GetForm.apply(this, arguments);\n}\n\nexport function SendFile(_x2) {\n  return _SendFile.apply(this, arguments);\n}\n\nfunction _SendFile() {\n  _SendFile = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(_ref) {\n    var csrf, file, formData, _cookie$get2, logintoken, apiUrl, response, data, error;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            csrf = _ref.csrf, file = _ref.file;\n            formData = new FormData();\n            _cookie$get2 = cookie.get(), logintoken = _cookie$get2.logintoken;\n            formData.append('__csrf_token', csrf);\n            formData.append('filename', file);\n            console.log({\n              logintoken: logintoken,\n              csrf: csrf,\n              file: file\n            });\n\n            if (!(logintoken && csrf && file)) {\n              _context2.next = 29;\n              break;\n            }\n\n            _context2.prev = 7;\n            apiUrl = 'https://prelude.eurobrake.net/upload';\n            _context2.next = 11;\n            return fetch(apiUrl, {\n              method: 'POST',\n              body: formData,\n              credentials: 'include',\n              headers: {\n                Authorization: 'Bearer ' + logintoken\n              }\n            });\n\n          case 11:\n            response = _context2.sent;\n            _context2.next = 14;\n            return response.json();\n\n          case 14:\n            data = _context2.sent;\n            _context2.next = 17;\n            return console.log({\n              data: data\n            });\n\n          case 17:\n            if (!(data.status === 'success')) {\n              _context2.next = 21;\n              break;\n            }\n\n            console.log('getForm', data);\n            _context2.next = 24;\n            break;\n\n          case 21:\n            error = new Error(data.error);\n            error.response = response;\n            throw error;\n\n          case 24:\n            _context2.next = 29;\n            break;\n\n          case 26:\n            _context2.prev = 26;\n            _context2.t0 = _context2[\"catch\"](7);\n            console.error('Failed to get form, please try again', _context2.t0); // this.setState({ error: error.message });\n\n          case 29:\n            return _context2.abrupt(\"return\");\n\n          case 30:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[7, 26]]);\n  }));\n  return _SendFile.apply(this, arguments);\n}\n\nexport function SendForm(_x3) {\n  return _SendForm.apply(this, arguments);\n}\n\nfunction _SendForm() {\n  _SendForm = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee4(_ref2) {\n    var _this = this;\n\n    var csrf, formData, url, form, _cookie$get3, logintoken, apiUrl, response, data, error;\n\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            csrf = _ref2.csrf, formData = _ref2.formData, url = _ref2.url;\n            form = _JSON$stringify(formData);\n            _cookie$get3 = cookie.get(), logintoken = _cookie$get3.logintoken;\n\n            if (!(logintoken && csrf && formData)) {\n              _context4.next = 24;\n              break;\n            }\n\n            _context4.prev = 4;\n            apiUrl = url;\n            _context4.next = 8;\n            return fetch(apiUrl, {\n              body: form,\n              credentials: 'include',\n              headers: {\n                Authorization: 'Bearer ' + logintoken\n              }\n            });\n\n          case 8:\n            response = _context4.sent;\n            _context4.next = 11;\n            return response.json();\n\n          case 11:\n            data = _context4.sent;\n\n            if (!(data.status === 'success')) {\n              _context4.next = 16;\n              break;\n            }\n\n            console.log('getForm', data);\n            _context4.next = 19;\n            break;\n\n          case 16:\n            error = new Error(data.error);\n            error.response = response;\n            throw error;\n\n          case 19:\n            _context4.next = 24;\n            break;\n\n          case 21:\n            _context4.prev = 21;\n            _context4.t0 = _context4[\"catch\"](4);\n            console.error('Failed to get form, please try again', _context4.t0);\n\n          case 24:\n            if (url === 'https://prelude.eurobrake.net/login') {\n              onSubmit =\n              /*#__PURE__*/\n              function () {\n                var _ref3 = _asyncToGenerator(\n                /*#__PURE__*/\n                _regeneratorRuntime.mark(function _callee3(e) {\n                  var _this$state, username, password, error, formData, _response, _data, _logintoken, _error;\n\n                  return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                    while (1) {\n                      switch (_context3.prev = _context3.next) {\n                        case 0:\n                          e.preventDefault();\n                          _this$state = _this.state, username = _this$state.username, password = _this$state.password, error = _this$state.error; // const apiUrl = authorLogin ? 'https://prelude.eurobrake.net/login' : '' ;\n                          // action=\"//2019.eurobrake.net/exhibition/exhibitors/login\" SHOULD BE LOGIN FORM FOR EXHIBITORS\n\n                          formData = {\n                            username: username,\n                            password: password\n                          };\n                          _context3.prev = 3;\n                          _context3.next = 6;\n                          return fetch('https://prelude.eurobrake.net/login', {\n                            method: 'POST',\n                            credentials: 'include',\n                            body: _JSON$stringify(formData),\n                            headers: {\n                              'Content-Type': 'application/json'\n                            }\n                          });\n\n                        case 6:\n                          _response = _context3.sent;\n                          _context3.next = 9;\n                          return _response.json();\n\n                        case 9:\n                          _data = _context3.sent;\n\n                          if (!(data2.status === 'success')) {\n                            _context3.next = 17;\n                            break;\n                          }\n\n                          _logintoken = _data.logintoken;\n                          _context3.next = 14;\n                          return login({\n                            logintoken: _logintoken\n                          });\n\n                        case 14:\n                          return _context3.abrupt(\"return\", {});\n\n                        case 17:\n                          _error = new Error(_data.error);\n                          _error.response = _response;\n                          throw _error;\n\n                        case 20:\n                          _context3.next = 26;\n                          break;\n\n                        case 22:\n                          _context3.prev = 22;\n                          _context3.t0 = _context3[\"catch\"](3);\n                          console.error('Failed to login, please try again', _context3.t0);\n\n                          _this.setState({\n                            error: _context3.t0.message\n                          });\n\n                        case 26:\n                        case \"end\":\n                          return _context3.stop();\n                      }\n                    }\n                  }, _callee3, null, [[3, 22]]);\n                }));\n\n                return function onSubmit(_x4) {\n                  return _ref3.apply(this, arguments);\n                };\n              }();\n            }\n\n            return _context4.abrupt(\"return\");\n\n          case 26:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4, null, [[4, 21]]);\n  }));\n  return _SendForm.apply(this, arguments);\n}","map":{"version":3,"sources":["/mnt/c/Users/D.Hardiman/desktop/eurobrake/components/forms/FormActions.js"],"names":["cookie","GetForm","url","get","logintoken","console","log","apiUrl","fetch","credentials","headers","Authorization","response","json","data","status","__csrf_token","error","Error","SendFile","csrf","file","formData","FormData","append","method","body","SendForm","form","onSubmit","e","preventDefault","state","username","password","data2","login","setState","message"],"mappings":"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","sourcesContent":["import cookie from 'js-cookie';\n\n\nexport async function GetForm(url) {\n    const { logintoken } = cookie.get();\n    console.log({ logintoken })\n    try {\n        const apiUrl = url;\n        const response = await fetch(apiUrl, {\n            credentials: 'include',\n            headers: {\n                Authorization: 'Bearer ' + logintoken,\n            }\n        });\n        const data = await response.json();\n        if (data.status === 'success') {\n            console.log('getForm', data);\n            console.log('tkn', data.__csrf_token)\n            return data;\n        } else {\n            let error = new Error(data.error)\n            error.response = response\n            throw error\n        }\n    } catch (error) {\n        console.error(\n            'Failed to get form, please try again', error\n        )\n        // return error.message\n    }\n    return\n}\n\nexport async function SendFile({ csrf, file }) {\n    const formData = new FormData();\n    const { logintoken } = cookie.get();\n    formData.append('__csrf_token', csrf);\n    formData.append('filename', file);\n    console.log({ logintoken, csrf, file })\n    if (logintoken && csrf && file) {\n        try {\n            const apiUrl = 'https://prelude.eurobrake.net/upload';\n            const response = await fetch(apiUrl, {\n                method: 'POST',\n                body: formData,\n                credentials: 'include',\n                headers: {\n                    Authorization: 'Bearer ' + logintoken,\n                }\n            });\n            const data = await response.json();\n            await console.log({ data })\n            if (data.status === 'success') {\n                console.log('getForm', data);\n\n            } else {\n                let error = new Error(data.error)\n                error.response = response\n                throw error\n            }\n        } catch (error) {\n            console.error(\n                'Failed to get form, please try again', error\n            )\n            // this.setState({ error: error.message });\n        }\n    }\n\n    return\n}\n\n\nexport async function SendForm({ csrf, formData, url }) {\n    const form = JSON.stringify(formData);\n    const { logintoken } = cookie.get();\n    if (logintoken && csrf && formData) {\n        try {\n            const apiUrl = url;\n            const response = await fetch(apiUrl, {\n                body: form,\n                credentials: 'include',\n                headers: {\n                    Authorization: 'Bearer ' + logintoken,\n                }\n            });\n            const data = await response.json();\n\n            if (data.status === 'success') {\n                console.log('getForm', data);\n            } else {\n                let error = new Error(data.error)\n                error.response = response\n                throw error\n            }\n        } catch (error) {\n            console.error(\n                'Failed to get form, please try again', error\n            )\n        }\n    }\n    if(url === 'https://prelude.eurobrake.net/login' ){\n          onSubmit = async (e) => {\n        e.preventDefault()\n        const { username, password, error } = this.state;\n        // const apiUrl = authorLogin ? 'https://prelude.eurobrake.net/login' : '' ;\n        // action=\"//2019.eurobrake.net/exhibition/exhibitors/login\" SHOULD BE LOGIN FORM FOR EXHIBITORS\n        const formData = {\n            username: username,\n            password: password,\n        }\n        try {\n            const response = await fetch('https://prelude.eurobrake.net/login', {\n                method: 'POST', \n                credentials: 'include',\n                body: JSON.stringify(formData),\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n            });\n         \n            const data = await response.json()\n            \n       \n\n            if (data2.status === 'success') {\n                const { logintoken } = data;\n                await login({ logintoken })\n                return {}\n\n            } else {\n                let error = new Error(data.error)\n                error.response = response\n                throw error\n            }\n        } catch (error) {\n            console.error(\n                'Failed to login, please try again', error\n            )\n            this.setState({ error: error.message });\n         }\n        }\n    }\n    return\n}\n"]},"metadata":{},"sourceType":"module"}