{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/mnt/c/Users/D.Hardiman/desktop/eurobrake/components/login.js\";\nvar __jsx = React.createElement;\nimport React, { Component } from 'react';\nimport styled from 'styled-components';\nimport fetch from 'isomorphic-unfetch';\nimport TextField from '@material-ui/core/TextField';\nimport { login, logout } from '../utils/auth';\nimport { Button } from './Button';\nvar StyledForm = styled.form.withConfig({\n  displayName: \"login__StyledForm\",\n  componentId: \"sc-1otdfux-0\"\n})([\"display:flex;flex-flow:column;justify-content:space-between;align-items:center;min-width:100%;.MuiInput-underline:after{color:\", \";}.MuiInputBase-root{font-family:\", \";font-size:2rem;color:\", \";}input:-internal-autofill-selected{}.login_form{&-field{margin:1rem 0;width:100%;display:flex;justify-content:space-between;align-items:flex-end;}&-label{font-family:\", \";font-size:2.6rem;color:\", \";}&-input{min-width:40rem;font-family:\", \";font-size:5rem;color:\", \";}&-link{font-family:\", \";font-size:1.7rem;color:\", \";}}\"], function (props) {\n  return props.theme.primary;\n}, function (props) {\n  return props.theme.MPBoldIt;\n}, function (props) {\n  return props.theme.primary;\n}, function (props) {\n  return props.theme.MPLight;\n}, function (props) {\n  return props.theme.primary;\n}, function (props) {\n  return props.theme.MPBoldIt;\n}, function (props) {\n  return props.theme.primary;\n}, function (props) {\n  return props.theme.MPBoldIt;\n}, function (props) {\n  return props.theme.primary;\n});\n\nvar Login =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Login, _Component);\n\n  function Login(props) {\n    var _this;\n\n    _classCallCheck(this, Login);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Login).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"saveToState\", function (e) {\n      _this.setState(_defineProperty({}, e.target.name, e.target.value));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSubmit\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(e) {\n        var _this$state, username, password, error, formData, response, data, data2, logintoken, _error;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                e.preventDefault();\n                _this$state = _this.state, username = _this$state.username, password = _this$state.password, error = _this$state.error; // const apiUrl = authorLogin ? 'https://prelude.eurobrake.net/login' : '' ;\n                // action=\"//2019.eurobrake.net/exhibition/exhibitors/login\" SHOULD BE LOGIN FORM FOR EXHIBITORS\n\n                formData = {\n                  username: username,\n                  password: password\n                };\n                _context.prev = 3;\n                _context.next = 6;\n                return fetch('https://prelude.eurobrake.net/login', {\n                  method: 'POST',\n                  credentials: 'include',\n                  body: _JSON$stringify(formData),\n                  headers: {\n                    'Content-Type': 'application/json'\n                  }\n                });\n\n              case 6:\n                response = _context.sent;\n                _context.next = 9;\n                return response;\n\n              case 9:\n                data = _context.sent;\n                _context.next = 12;\n                return response.json();\n\n              case 12:\n                data2 = _context.sent;\n                console.log('login', _JSON$stringify(data2));\n\n                if (!(data2.status === 'success')) {\n                  _context.next = 21;\n                  break;\n                }\n\n                logintoken = data2.logintoken;\n                _context.next = 18;\n                return login({\n                  logintoken: logintoken\n                });\n\n              case 18:\n                return _context.abrupt(\"return\", {});\n\n              case 21:\n                _error = new Error(data.error);\n                _error.response = response;\n                throw _error;\n\n              case 24:\n                _context.next = 30;\n                break;\n\n              case 26:\n                _context.prev = 26;\n                _context.t0 = _context[\"catch\"](3);\n                console.error('Failed to login, please try again', _context.t0);\n\n                _this.setState({\n                  error: _context.t0.message\n                });\n\n              case 30:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[3, 26]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _this.state = {\n      username: '',\n      password: '',\n      error: ''\n    };\n    return _this;\n  }\n\n  _createClass(Login, [{\n    key: \"render\",\n    value: function render() {\n      return __jsx(StyledForm, {\n        className: \"login_form\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: \"login_form-field\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }, __jsx(\"label\", {\n        htmlFor: \"label\",\n        className: \"login_form-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, \"Email:\"), __jsx(TextField, {\n        style: {\n          color: '#134381'\n        },\n        label: \"Required\",\n        className: \"login_form-input\",\n        type: \"text\",\n        name: \"username\",\n        onChange: this.saveToState,\n        value: this.state.username,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      })), __jsx(\"div\", {\n        className: \"login_form-field\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, __jsx(\"label\", {\n        className: \"login_form-label\",\n        htmlFor: \"label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, \"Password:\"), __jsx(TextField, {\n        label: \"Required\",\n        className: \"login_form-input\",\n        type: \"password\",\n        name: \"password\",\n        onChange: this.saveToState,\n        value: this.state.password,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      })), __jsx(Button, {\n        onClick: this.onSubmit,\n        value: \"Submit\",\n        bcolor: \"#134381\",\n        background: \"#134381\",\n        br: \"100rem\",\n        style: {\n          margin: \"3rem 0\"\n        },\n        fs: \"1.8rem\",\n        padding: \".5rem 6rem\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, \"Login\"), __jsx(\"a\", {\n        className: \"login_form-link\",\n        href: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, \"Forgotten your password?\"));\n    }\n  }]);\n\n  return Login;\n}(Component);\n\nexport { Login as default };","map":{"version":3,"sources":["/mnt/c/Users/D.Hardiman/desktop/eurobrake/components/login.js"],"names":["React","Component","styled","fetch","TextField","login","logout","Button","StyledForm","form","props","theme","primary","MPBoldIt","MPLight","Login","e","setState","target","name","value","preventDefault","state","username","password","error","formData","method","credentials","body","headers","response","data","json","data2","console","log","status","logintoken","Error","message","color","saveToState","onSubmit","margin"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport styled from 'styled-components';\nimport fetch from 'isomorphic-unfetch';\nimport TextField from '@material-ui/core/TextField';\nimport { login, logout } from '../utils/auth';\nimport {Button} from './Button';\n\n\nconst StyledForm = styled.form`\n    display: flex;\n    flex-flow: column;\n    justify-content: space-between;\n    align-items: center;\n    min-width: 100%;\n\n    \n.MuiInput-underline:after {\n    color: ${props => props.theme.primary};\n}\n\n.MuiInputBase-root {\n    font-family: ${props => props.theme.MPBoldIt};\n        font-size: 2rem;\n        color: ${props => props.theme.primary};\n}\n\ninput:-internal-autofill-selected {\n\n}\n    .login_form{\n\n    &-field{\n        margin: 1rem 0;\n        width: 100%;\n        display: flex;\n        justify-content: space-between;\n        align-items: flex-end;\n    }\n    &-label{\n        font-family: ${props => props.theme.MPLight};\n        font-size: 2.6rem;\n        color: ${props => props.theme.primary};\n    }\n    &-input{\n        min-width: 40rem;\n        font-family: ${props => props.theme.MPBoldIt};\n        font-size: 5rem;\n        color: ${props => props.theme.primary};\n\n    }\n\n    &-link{\n        font-family: ${props => props.theme.MPBoldIt};\n        font-size: 1.7rem;\n        color: ${props => props.theme.primary};\n    }\n    }\n\n\n`;\n\nexport default class Login extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            username: '',\n            password: '',\n            error: ''\n        }\n    }\n\n    saveToState = (e) => {\n        this.setState({ [e.target.name]: e.target.value });\n    }\n\n    onSubmit = async (e) => {\n        e.preventDefault()\n        const { username, password, error } = this.state;\n        // const apiUrl = authorLogin ? 'https://prelude.eurobrake.net/login' : '' ;\n        // action=\"//2019.eurobrake.net/exhibition/exhibitors/login\" SHOULD BE LOGIN FORM FOR EXHIBITORS\n        const formData = {\n            username: username,\n            password: password,\n        }\n        try {\n            const response = await fetch('https://prelude.eurobrake.net/login', {\n                method: 'POST', \n                credentials: 'include',\n                body: JSON.stringify(formData),\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n            });\n            const data = await response\n            const data2 = await response.json()\n            \n            console.log('login', JSON.stringify(data2))\n\n            if (data2.status === 'success') {\n                const { logintoken } = data2;\n                await login({ logintoken })\n                // this.setState(prev => ({ userLoggedIn: !prev }))\n                return {}\n\n            } else {\n                let error = new Error(data.error)\n                error.response = response\n                throw error\n            }\n        } catch (error) {\n            console.error(\n                'Failed to login, please try again', error\n            )\n            this.setState({ error: error.message });\n        }\n    }\n    render() {\n        return (\n           \n                   <StyledForm className=\"login_form\">\n                        <div className=\"login_form-field\">\n                            <label \n                            htmlFor=\"label\" \n                            className=\"login_form-label\">\n                                Email:\n                            </label>\n                            <TextField\n                            style={{color: '#134381'}}\n                            label=\"Required\"\n                            className=\"login_form-input\" \n                            type=\"text\"\n                            name=\"username\"\n                            onChange={this.saveToState} \n                            value={this.state.username} />\n                        </div>\n                        <div className=\"login_form-field\">\n                            <label \n                            className=\"login_form-label\"\n                             htmlFor=\"label\">\n                                Password:\n                            </label>\n                            <TextField\n                            label=\"Required\"\n                            className=\"login_form-input\" \n                            type=\"password\"\n                            name=\"password\"\n                            onChange={this.saveToState} \n                            value={this.state.password} />\n                        </div>\n                        <Button \n                        onClick={this.onSubmit} \n                        value=\"Submit\" \n                        bcolor=\"#134381\"\n                        background=\"#134381\"\n                        br=\"100rem\"\n                        style={{ margin: \"3rem 0\"}}\n                        fs=\"1.8rem\"\n                        padding=\".5rem 6rem\"\n                        >Login</Button>\n                        <a className=\"login_form-link\" href=\"\">Forgotten your password?</a>\n                   </StyledForm>\n          \n             \n        )\n    }\n}\n\n"]},"metadata":{},"sourceType":"module"}