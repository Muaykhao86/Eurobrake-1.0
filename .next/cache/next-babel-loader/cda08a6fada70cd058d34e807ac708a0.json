{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport React from 'react';\nimport cookie from 'js-cookie';\nexport function GetForm(_x) {\n  return _GetForm.apply(this, arguments);\n}\n\nfunction _GetForm() {\n  _GetForm = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(url) {\n    var _cookie$get, logintoken, apiUrl, response, data, error;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _cookie$get = cookie.get(), logintoken = _cookie$get.logintoken;\n            console.log({\n              logintoken: logintoken\n            });\n            _context.prev = 2;\n            apiUrl = url;\n            _context.next = 6;\n            return fetch(apiUrl, {\n              credentials: 'include',\n              headers: {\n                Authorization: 'Bearer ' + logintoken\n              }\n            });\n\n          case 6:\n            response = _context.sent;\n            _context.next = 9;\n            return response.json();\n\n          case 9:\n            data = _context.sent;\n\n            if (!(data.status === 'success')) {\n              _context.next = 16;\n              break;\n            }\n\n            console.log('getForm', data);\n            console.log('tkn', data.__csrf_token);\n            return _context.abrupt(\"return\", data.__csrf_token);\n\n          case 16:\n            error = new Error(data.error);\n            error.response = response;\n            throw error;\n\n          case 19:\n            _context.next = 24;\n            break;\n\n          case 21:\n            _context.prev = 21;\n            _context.t0 = _context[\"catch\"](2);\n            console.error('Failed to get form, please try again', _context.t0); // return error.message\n\n          case 24:\n            return _context.abrupt(\"return\");\n\n          case 25:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[2, 21]]);\n  }));\n  return _GetForm.apply(this, arguments);\n}\n\nexport function SendFile(_x2) {\n  return _SendFile.apply(this, arguments);\n}\n\nfunction _SendFile() {\n  _SendFile = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(_ref) {\n    var csrf, file, formData, _cookie$get2, logintoken, apiUrl, response, data, error;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            csrf = _ref.csrf, file = _ref.file;\n            formData = new FormData();\n            _cookie$get2 = cookie.get(), logintoken = _cookie$get2.logintoken;\n            formData.append('__csrf_token', {\n              csrf: csrf\n            });\n            formData.append('filename', {\n              file: file\n            });\n            console.log({\n              logintoken: logintoken,\n              csrf: csrf,\n              file: file\n            });\n\n            if (!(logintoken && csrf && file)) {\n              _context2.next = 27;\n              break;\n            }\n\n            _context2.prev = 7;\n            apiUrl = 'https://prelude.eurobrake.net/upload';\n            _context2.next = 11;\n            return fetch(apiUrl, {\n              method: 'PUT',\n              body: formData,\n              credentials: 'include',\n              headers: {\n                Authorization: 'Bearer ' + logintoken\n              }\n            });\n\n          case 11:\n            response = _context2.sent;\n            _context2.next = 14;\n            return response.json();\n\n          case 14:\n            data = _context2.sent;\n\n            if (!(data.status === 'success')) {\n              _context2.next = 19;\n              break;\n            }\n\n            console.log('getForm', data);\n            _context2.next = 22;\n            break;\n\n          case 19:\n            error = new Error(data.error);\n            error.response = response;\n            throw error;\n\n          case 22:\n            _context2.next = 27;\n            break;\n\n          case 24:\n            _context2.prev = 24;\n            _context2.t0 = _context2[\"catch\"](7);\n            console.error('Failed to get form, please try again', _context2.t0); // this.setState({ error: error.message });\n\n          case 27:\n            return _context2.abrupt(\"return\");\n\n          case 28:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[7, 24]]);\n  }));\n  return _SendFile.apply(this, arguments);\n}\n\nexport function SendForm(_x3) {\n  return _SendForm.apply(this, arguments);\n}\n\nfunction _SendForm() {\n  _SendForm = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee3(_ref2) {\n    var csrf, formData, url, form, _cookie$get3, logintoken, apiUrl, response, data, error;\n\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            csrf = _ref2.csrf, formData = _ref2.formData, url = _ref2.url;\n            form = _JSON$stringify(formData);\n            _cookie$get3 = cookie.get(), logintoken = _cookie$get3.logintoken;\n\n            if (!(logintoken && csrf && formData)) {\n              _context3.next = 24;\n              break;\n            }\n\n            _context3.prev = 4;\n            apiUrl = url;\n            _context3.next = 8;\n            return fetch(apiUrl, {\n              body: form,\n              credentials: 'include',\n              headers: {\n                Authorization: 'Bearer ' + logintoken\n              }\n            });\n\n          case 8:\n            response = _context3.sent;\n            _context3.next = 11;\n            return response.json();\n\n          case 11:\n            data = _context3.sent;\n\n            if (!(data.status === 'success')) {\n              _context3.next = 16;\n              break;\n            }\n\n            console.log('getForm', data);\n            _context3.next = 19;\n            break;\n\n          case 16:\n            error = new Error(data.error);\n            error.response = response;\n            throw error;\n\n          case 19:\n            _context3.next = 24;\n            break;\n\n          case 21:\n            _context3.prev = 21;\n            _context3.t0 = _context3[\"catch\"](4);\n            console.error('Failed to get form, please try again', _context3.t0); // this.setState({ error: error.message });\n\n          case 24:\n            return _context3.abrupt(\"return\");\n\n          case 25:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[4, 21]]);\n  }));\n  return _SendForm.apply(this, arguments);\n}","map":null,"metadata":{},"sourceType":"module"}